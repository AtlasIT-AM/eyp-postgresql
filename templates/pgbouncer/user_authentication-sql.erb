
CREATE OR REPLACE FUNCTION user_authentication(uname TEXT) RETURNS TABLE (usename name, passwd text) as
$$
SELECT usename, passwd FROM pg_shadow WHERE usename=$1;
$$
LANGUAGE sql SECURITY DEFINER;

REVOKE EXECUTE ON FUNCTION public.user_authentication(text) FROM PUBLIC;
GRANT EXECUTE ON FUNCTION public.user_authentication(text) TO pgbouncer;
